<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>ComboCode.cc.modeling.tools.Reddening</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ComboCode-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="ComboCode-module.html">Package&nbsp;ComboCode</a> ::
        <a href="ComboCode.cc-module.html">Package&nbsp;cc</a> ::
        <a href="ComboCode.cc.modeling-module.html">Package&nbsp;modeling</a> ::
        <a href="ComboCode.cc.modeling.tools-module.html">Package&nbsp;tools</a> ::
        Module&nbsp;Reddening
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="ComboCode.cc.modeling.tools.Reddening-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module Reddening</h1><p class="nomargin-top"><span class="codelink"><a href="ComboCode.cc.modeling.tools.Reddening-pysrc.html">source&nbsp;code</a></span></p>
<p>Toolbox for interstellar Reddening of models or dereddening of data, 
  and interstellar extinction laws.</p>
  <p>Author: R. Lombaert</p>
  <p>How does reddening in ComboCode work?</p>
  <p>First and foremost, we define the interstellar extinction in the 
  Johnson K band. The magnitude of extinction, Ak, is derived from 
  extinction models. Either from Marshall et al. 2006, or from Schlegel et 
  al. 1998 if not available from the former. Ak requires the distance to be
  given, before it can be applied to a model. All of our modeling requires 
  a distance as input, so this is not an issue in practice. If needed, the 
  extinction model can be changed to a different 3d galactic map from 
  marshall (or Schlegel), see getAk.</p>
  <p>A note on the extinction models. Schlegel et al say that they could 
  not verify their values at |bb| &lt; 5 degrees, so they should not be 
  trusted. However, Sans Fuentes et al 2014 checked those values by 
  comparing them with OGLE maps for the |ll| &lt; 10 degrees region and 
  found a very good match. Common practice is to compare model values with 
  measurements, in -- for instance -- the IRSA catalog. 
  http://irsa.ipac.caltech.edu/applications/DUST/ (based on COBE/DIRBE 
  maps) Here, you can find total extinction in several bands. This then 
  needs to be converted to the distance you're looking at for your source. 
  It is more convenient to use galactic 3D models and do this exercise once
  for a given direction to see how accurate the models are.</p>
  <p>The interstellar extinction law of preference is that of Chiar and 
  Tielens 2006. This law is given normalized per Ak and can be directly 
  combined with the interstellar extinction given from Marshall or 
  Schlegel. We use the curve for the local ISM. The alternative is a curve 
  for the galactic center, but even in the direction of the galactic center
  the local ISM doesn't change much in terms of dust extinction, except at 
  very large distances on the order of 5kpc or more. We don't work with 
  sources at those distances for now, so we can safely ignore it. For 
  completeness, the GC curve is made as well and provided as an option in 
  the reddening module of IvS repo.</p>
  <p>However, while Marshall gives Ak and presents no issue, other maps 
  give Av. To convert Av to Ak, we have to convert the V-band normalization
  of Drimmel to K-band normalization. Chiar and Tielens, however, derived a
  law only in the IR hence no V-band normalization can be defined. We need 
  a different interstellar reddening law in V-band to be compared with the 
  infrared law of the former. The most recent V-band reddening law is given
  by Fitzpatrick 2004.</p>
  <p>We therefore created our own interstellar reddening law from the 
  combination of Fitzpatrick 2004 up to the wavelength where Chiar and 
  Tielens 2006 begins. They match almost identically in the overlapping 
  region, following a power law of the form lambda**-1.8. From there, the 
  combined law follows Chiar and Tielens, and is extrapolated to further 
  wavelengths with the same power law with power -1.8 as mentioned by Chiar
  &amp; Tielens 2006 between 2 and 5 micron. At long wavelengths, the 
  extinction becomes negligible, so the extrapolation is barely noticeable,
  but maintains consistency.</p>
  <p>To convert Fitzpatrick 2004 to Ak, we do need to assume a Av to Ak 
  conversion that does not take into account Chiar and Tielens. The latter 
  suggest their law can be converted back to Av with a factor of ak/av = 
  0.09, which is in very good agreement with the factor derived from 
  fitzpatrick 2004 itself: 0.088.</p>
  <p>Using this self-constructed reddening law, we can now convert Av to Ak
  from Drimmel, and then apply that Ak together with the self-constructed 
  reddening law to redden our models. We use the IvS repository for the 
  reddening.</p>

<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">float</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ComboCode.cc.modeling.tools.Reddening-module.html#getAk" class="summary-sig-name">getAk</a>(<span class="summary-sig-arg">ll</span>,
        <span class="summary-sig-arg">bb</span>,
        <span class="summary-sig-arg">distance</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">map</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">marshall</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">law</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">fitz2004chiar2006</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">lawtype</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">ism</code><code class="variable-quote">'</code></span>)</span><br />
      Find the Johnson K-band interstellar extinction at given longitude 
      and latitude for a given galactic extinction model.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ComboCode.cc.modeling.tools.Reddening-pysrc.html#getAk">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ComboCode.cc.modeling.tools.Reddening-module.html#redden" class="summary-sig-name">redden</a>(<span class="summary-sig-arg">wave</span>,
        <span class="summary-sig-arg">flux</span>,
        <span class="summary-sig-arg">ak</span>,
        <span class="summary-sig-arg">law</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">Fitz2004Chiar2006</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">lawtype</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">ism</code><code class="variable-quote">'</code></span>)</span><br />
      Redden model fluxes, correcting for interstellar extinction.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ComboCode.cc.modeling.tools.Reddening-pysrc.html#redden">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ComboCode.cc.modeling.tools.Reddening-module.html#combineRedLaw" class="summary-sig-name">combineRedLaw</a>(<span class="summary-sig-arg">ofn</span>,
        <span class="summary-sig-arg">chiar_curve</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">ism</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">power</span>=<span class="summary-sig-default">-1.8</span>)</span><br />
      A method to combine the Fitzpatrick 2004 and Chiar &amp; Tielens 2006
      reddening laws as well as to extrapolate Chiar and Tielens 2006 to 
      longer wavelengths.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ComboCode.cc.modeling.tools.Reddening-pysrc.html#combineRedLaw">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="__package__"></a><span class="summary-name">__package__</span> = <code title="'ComboCode.cc.modeling.tools'"><code class="variable-quote">'</code><code class="variable-string">ComboCode.cc.modeling.tools</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="getAk"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">getAk</span>(<span class="sig-arg">ll</span>,
        <span class="sig-arg">bb</span>,
        <span class="sig-arg">distance</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">map</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">marshall</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">law</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">fitz2004chiar2006</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">lawtype</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">ism</code><code class="variable-quote">'</code></span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ComboCode.cc.modeling.tools.Reddening-pysrc.html#getAk">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Find the Johnson K-band interstellar extinction at given longitude and
  latitude for a given galactic extinction model.</p>
  <p>Default is marshall, and if not available there, schlegel. When 
  marshall is requested, schlegel is always returned for ll and bb outside 
  the range of marshall.</p>
  <p>Alternatives are arenou, drimmel and schlegel, see ivs repo.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>ll</code></strong> (float) - The galactic longitude of the star</li>
        <li><strong class="pname"><code>bb</code></strong> (float) - The galactic latitude of the star</li>
        <li><strong class="pname"><code>distance</code></strong> (float) - Distance to the star. Default is None, in which case the full 
          extinction to infinity in a given direction is returned
          <p>(default: None)</p></li>
        <li><strong class="pname"><code>map</code></strong> (str) - The galactic 3d extinction model.
          <p>(default: 'marshall')</p></li>
        <li><strong class="pname"><code>law</code></strong> (str) - The reddening law
          <p>(default: 'fitz2004chiar2006')</p></li>
        <li><strong class="pname"><code>lawtype</code></strong> (str) - The type of Chiar &amp; Tielens reddening law (either ism or gc).
          Only when relevant.
          <p>(default: 'ism')</p></li>
    </ul></dd>
    <dt>Returns: float</dt>
        <dd>The interstellar extinction magnitude in K-band</dd>
  </dl>
</td></tr></table>
</div>
<a name="redden"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">redden</span>(<span class="sig-arg">wave</span>,
        <span class="sig-arg">flux</span>,
        <span class="sig-arg">ak</span>,
        <span class="sig-arg">law</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">Fitz2004Chiar2006</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">lawtype</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">ism</code><code class="variable-quote">'</code></span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ComboCode.cc.modeling.tools.Reddening-pysrc.html#redden">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Redden model fluxes, correcting for interstellar extinction.</p>
  <p>Flux is assumed to be flux, and not magnitudes!</p>
  <p>For dereddening, pass -ak instead.</p>
  <p>The reddening law can be chosen, but should probably be 
  Fitz2004Chiar2006 as it was tailored to infrared reddening of AGB sources
  in the Solar neighbourhood.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>wave</code></strong> (array) - The wavelength grid</li>
        <li><strong class="pname"><code>flux</code></strong> (array) - The flux from the models</li>
        <li><strong class="pname"><code>ak</code></strong> (float) - The interstellar reddening magnitude in Johnson K-band</li>
        <li><strong class="pname"><code>law</code></strong> (str) - The reddening law
          <p>(default: 'Fitz2004Chiar2006')</p></li>
        <li><strong class="pname"><code>lawtype</code></strong> (str) - The type of Chiar &amp; Tielens reddening law (either ism or gc)
          <p>(default: 'ism')</p></li>
    </ul></dd>
    <dt>Returns: array</dt>
        <dd>The reddened fluxes</dd>
  </dl>
</td></tr></table>
</div>
<a name="combineRedLaw"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">combineRedLaw</span>(<span class="sig-arg">ofn</span>,
        <span class="sig-arg">chiar_curve</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">ism</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">power</span>=<span class="sig-default">-1.8</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ComboCode.cc.modeling.tools.Reddening-pysrc.html#combineRedLaw">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>A method to combine the Fitzpatrick 2004 and Chiar &amp; Tielens 2006 
  reddening laws as well as to extrapolate Chiar and Tielens 2006 to longer
  wavelengths.</p>
  <p>The result is saved in a file and used by the IvS repository as a 
  valid reddening law.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>ofn</code></strong> (str) - The output filename with path</li>
        <li><strong class="pname"><code>chiar_curve</code></strong> (str) - The curve type for Chiar &amp; Tielens 2004. Either 'gc' or 
          'ism'.
          <p>(default: 'ism')</p></li>
        <li><strong class="pname"><code>power</code></strong> (float) - The power for the power law extrapolation. Default is taken from 
          Chiar and Tielens 2006, as a typical value for local ISM between 
          2 and 5 micron. gc may require different value but not very 
          important.
          <p>(default: -1.8)</p></li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ComboCode-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Mon Nov  7 18:01:56 2016
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
